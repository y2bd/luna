(this.webpackJsonpluna=this.webpackJsonpluna||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),c=n(3),i=n.n(c),l=(n(9),n(1));n(10);function s(){var e=o.useState(),t=Object(l.a)(e,2),n=t[0],a=t[1],r=new URLSearchParams;return r.append("grant_type","https://oauth.reddit.com/grants/installed_client"),r.append("device_id","DO_NOT_TRACK_THIS_DEVICE"),o.useEffect((function(){fetch("https://www.reddit.com/api/v1/access_token",{method:"POST",body:r,headers:{Authorization:"Basic RDVOdkpIcmN0UFNFTWc6","Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}}).then((function(e){return e.json()})).then((function(e){a(null===e||void 0===e?void 0:e.access_token)}))}),[]),{accessToken:n}}function u(){var e=o.useState(),t=Object(l.a)(e,2),n=t[0],a=t[1],r=o.useState(),c=Object(l.a)(r,2),i=c[0],s=c[1],u=o.useCallback((function(){if(window.location.hash){var e=window.location.hash.match("^#?([A-Za-z0-9_]+)/?([A-Za-z0-9_]+)?$"),t=null!==e&&void 0!==e?e:[],n=Object(l.a)(t,3),o=(n[0],n[1]),r=n[2];a(o||void 0),s(r||void 0),document.title=o?"Luna - "+o:"Luna"}else window.location.hash="popular"}),[a,s]),d=o.useCallback((function(){window.location.hash=n||""}),[n]),m=o.useCallback((function(e,t){window.location.hash="".concat(e,"/").concat(t)}),[]);return o.useEffect((function(){return window.addEventListener("hashchange",u),u(),function(){return window.removeEventListener("hashchange",u)}})),{subreddit:n,article:i,goHome:d,goToArticle:m}}!function(e){e.Best="best",e.New="new"}(a||(a={}));var d=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Best,n=o.useState([]),r=Object(l.a)(n,2),c=r[0],i=r[1],u=o.useState(!1),d=Object(l.a)(u,2),m=d[0],h=d[1],f=o.useState(void 0),p=Object(l.a)(f,2),v=p[0],w=p[1],b=s(),E=b.accessToken;return o.useEffect((function(){h(!0),E&&fetch("https://oauth.reddit.com/r/".concat(e,"/").concat(t,".json?raw_json=1"),{headers:{Authorization:"bearer "+E,"User-Agent":"web:me.y2bd.luna:v0.1.0 (by /u/y2bd)"}}).then((function(e){return e.json()})).then((function(e){i(e.data.children),h(!1),w(void 0)})).catch((function(e){w(e),h(!1)}))}),[E,e,t]),{posts:c,loading:m,error:v}}(e.subreddit),n=t.posts,r=t.loading,c=t.error;return o.createElement("div",{className:"App"},r&&o.createElement("p",null,"Loading..."),c&&o.createElement("p",null,"Error Whoops... ",c.message),n&&n.map((function(e){return o.createElement(m,Object.assign({key:e.data.id},e))})))},m=function(e){var t=u().goToArticle,n=e.expanded,a=e.data,r=a.id,c=a.permalink,i=a.url,l=a.subreddit,s=a.selftext_html,d=o.useCallback((function(){return window.open(i)}),[c]),m=o.useCallback((function(e){e.stopPropagation(),t(l,r)}),[l,r]),h=o.useCallback((function(e){return e.preventDefault()}),[]),f=o.useMemo((function(){var e;return null===(e=i.match("^https?://(?:www\\.)?(.+?)(?:/.*)?$"))||void 0===e?void 0:e[1]}),[i]);return o.createElement("div",{className:"Post",onClick:d},o.createElement("div",{className:"PostData"},o.createElement("a",{href:i,onClick:h},e.data.title),o.createElement("aside",null,f),n&&s&&o.createElement("article",{dangerouslySetInnerHTML:{__html:s}})),!n&&o.createElement("aside",{className:"CommentButton",onClick:m},o.createElement("a",null,"\u275e")))},h=function(e){var t=function(e,t){var n=o.useState(),a=Object(l.a)(n,2),r=a[0],c=a[1],i=o.useState([]),u=Object(l.a)(i,2),d=u[0],m=u[1],h=o.useState(!1),f=Object(l.a)(h,2),p=f[0],v=f[1],w=o.useState(void 0),b=Object(l.a)(w,2),E=b[0],g=b[1],y=s().accessToken;return o.useEffect((function(){v(!0),y&&fetch("https://oauth.reddit.com/r/".concat(e,"/comments/").concat(t,".json?raw_json=1"),{headers:{Authorization:"bearer "+y,"User-Agent":"web:me.y2bd.luna:v0.1.0 (by /u/y2bd)"}}).then((function(e){return e.json()})).then((function(e){c(e[0].data.children[0]),m(e[1].data.children),g(void 0),v(!1)})).catch((function(e){g(e),v(!1)}))}),[e,t,y]),{post:r,replies:d,loading:p,error:E}}(e.subreddit,e.article),n=t.post,a=t.replies,r=t.loading,c=t.error;return o.useLayoutEffect((function(){document.querySelectorAll(".ReplyData .md a").forEach((function(e){var t=e;t.target="_blank",t.href.includes(window.location.host)&&(t.href="https://reddit.com"+t.href.slice(window.location.origin.length))}))}),[a]),o.createElement("div",{className:"App"},r&&o.createElement("p",null,"Loading..."),c&&o.createElement("p",null,"Error Whoops... ",c.message),n&&o.createElement(m,Object.assign({expanded:!0},n)),a&&a.map((function(e){return o.createElement(f,Object.assign({key:e.data.id,index:-1},e))})))},f=function e(t){var n,a,r=t.indent,c=void 0===r?0:r,i=t.index,s=t.data,u=s.body_html,d=s.replies,m=o.useState(!0),h=Object(l.a)(m,2),f=h[0],p=h[1],v=o.useRef(null),w=(null!==(n=null===d||void 0===d||null===(a=d.data)||void 0===a?void 0:a.children.filter((function(e){return!!e.data.body})).length)&&void 0!==n?n:0)>0,b=0===i,E=-1===i;return o.createElement(o.Fragment,null,o.createElement("div",{className:"Reply "+(E?"Top ":""),ref:v,onClick:function(e){var t;w&&("a"===e.target.tagName.toLowerCase()||(null===(t=window.getSelection())||void 0===t?void 0:t.toString())||p(!f))}},o.createElement("div",{style:{display:"flex"}},new Array(c).fill(0).map((function(){return o.createElement("div",{className:"Indent"})}))),o.createElement("div",{className:"ReplyData "+(w?"Children ":"")+(b?"First ":"")},o.createElement("article",{dangerouslySetInnerHTML:{__html:u}}))),f&&d&&d.data.children.filter((function(e){return!!e.data.body})).map((function(t,n){return o.createElement(e,Object.assign({key:t.data.id+t.data.author,index:n,indent:c+1},t))})),!f&&o.createElement("div",{className:"Collapsed"}),E&&o.createElement("div",{className:"Collapsed"}))},p=function(){var e=u(),t=e.subreddit,n=e.article;return t&&n?o.createElement(h,{subreddit:t,article:n}):t?o.createElement(d,{subreddit:t}):o.createElement("div",{className:"App"},o.createElement("p",null,"Loading..."))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[4,1,2]]]);
//# sourceMappingURL=main.7cbc6192.chunk.js.map