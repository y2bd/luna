{"version":3,"sources":["reddit/reddit.ts","reddit/oauth.ts","reddit/url.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["Sort","useOAuth","React","accessToken","setAccessToken","form","URLSearchParams","append","fetch","method","body","headers","Authorization","then","response","json","access_token","useUrl","subreddit","setSubreddit","article","setArticle","onHash","window","location","hash","match","sub","art","undefined","document","title","goHome","goToArticle","addEventListener","removeEventListener","PostsView","sort","Hot","posts","setPosts","loading","setLoading","error","setError","console","log","data","children","catch","err","useSubreddit","className","message","map","post","key","id","PostView","expanded","permalink","url","selftext_html","onDivClick","open","onCommentClick","evt","stopPropagation","onLinkClick","preventDefault","domain","onClick","href","dangerouslySetInnerHTML","__html","RepliesView","setPost","replies","setReplies","credentials","usePost","querySelectorAll","forEach","elem","anchor","target","includes","host","slice","origin","length","reply","index","ReplyView","indent","body_html","setExpanded","divRef","hasChildren","filter","child","isFirst","isTop","ref","e","tagName","toLowerCase","getSelection","toString","style","display","Array","fill","author","App","Boolean","hostname","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.257f0f6e.chunk.js","sourcesContent":["import * as React from \"react\";\nimport { useOAuth } from \"./oauth\";\n\nexport interface PostListing {\n  kind: \"Listing\";\n  data: {\n    dist: number;\n    before: string | undefined;\n    after: string | undefined;\n    children: Post[];\n  };\n}\n\nexport interface Post {\n  kind: \"t3\";\n  data: {\n    id: string;\n    name: string;\n    title: string;\n    author: string;\n    score: number;\n    permalink: string;\n    url: string;\n    created_utc: number;\n    subreddit: string;\n    selftext_html: string;\n  };\n\n  expanded?: boolean;\n}\n\nexport interface ReplyListing {\n  kind: \"Listing\";\n  data: {\n    dist: number;\n    before: string | undefined;\n    after: string | undefined;\n    children: Reply[];\n  };\n}\n\nexport interface Reply {\n  kind: \"t1\";\n  data: {\n    id: string;\n    name: string;\n    title: string;\n    author: string;\n    score: number;\n    permalink: string;\n    created_utc: number;\n    body: string;\n    body_html: string;\n    replies: ReplyListing;\n  };\n\n  indent?: number;\n  index?: number;\n  top?: boolean;\n}\n\nexport enum Sort {\n  Best = \"best\",\n  Hot = \"hot\",\n  New = \"new\"\n}\n\nexport function useSubreddit(subreddit: string, sort: Sort = Sort.Hot) {\n  const [posts, setPosts] = React.useState<Post[]>([]);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<Error | undefined>(undefined);\n  const { accessToken } = useOAuth();\n\n  React.useEffect(() => {\n    setLoading(true);\n    if (!accessToken) {\n      return;\n    }\n\n    console.log(\"acc\", accessToken);\n\n    fetch(\n      `https://oauth.reddit.com/r/${subreddit}/${sort}?api_type=json&raw_json=1`,\n      {\n        headers: {\n          Authorization: \"bearer \" + accessToken,\n          \"User-Agent\": \"web:me.y2bd.luna:v0.1.0 (by /u/y2bd)\"\n        },\n        method: \"GET\"\n      }\n    )\n      .then(response => response.json())\n      .then((json: PostListing) => {\n        setPosts(json.data.children);\n        setLoading(false);\n        setError(undefined);\n      })\n      .catch(err => {\n        setError(err);\n        setLoading(false);\n      });\n  }, [accessToken, subreddit, sort]);\n\n  return { posts, loading, error };\n}\n\nexport function usePost(subreddit: string, article: string) {\n  const [post, setPost] = React.useState<Post | undefined>();\n  const [replies, setReplies] = React.useState<Reply[]>([]);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<Error | undefined>(undefined);\n  const { accessToken } = useOAuth();\n\n  React.useEffect(() => {\n    setLoading(true);\n    if (!accessToken) {\n      return;\n    }\n\n    fetch(\n      `https://oauth.reddit.com/r/${subreddit}/comments/${article}?comment=&api_type=json&raw_json=1`,\n      {\n        headers: {\n          Authorization: \"bearer \" + accessToken,\n          \"User-Agent\": \"web:me.y2bd.luna:v0.1.0 (by /u/y2bd)\"\n        },\n        credentials: \"include\"\n      }\n    )\n      .then(response => response.json())\n      .then((json: [PostListing, ReplyListing]) => {\n        setPost(json[0].data.children[0]);\n        setReplies(json[1].data.children);\n        setError(undefined);\n        setLoading(false);\n      })\n      .catch(err => {\n        setError(err);\n        setLoading(false);\n      });\n  }, [subreddit, article, accessToken]);\n\n  return { post, replies, loading, error };\n}\n","import * as React from \"react\";\n\nexport function useOAuth() {\n  const [accessToken, setAccessToken] = React.useState<string>();\n\n  const form = new URLSearchParams();\n  form.append(\"grant_type\", \"client_credentials\");\n  // form.append(\"device_id\", \"DO_NOT_TRACK_THIS_DEVICE\");\n  form.append(\n    \"scope\",\n    \"identity,edit,flair,history,mysubreddits,privatemessages,read,report,save,submit,subscribe,vote,creddits\"\n  );\n\n  React.useEffect(() => {\n    fetch(\"https://www.reddit.com/api/v1/access_token\", {\n      method: \"POST\",\n      body: form,\n      headers: {\n        Authorization:\n          \"Basic ek90N2VtVjJDYzJHVVE6R3IxdW0wSUdqQkxLenN6OGlDUTV4elpFVVVn\"\n      }\n    })\n      .then(response => response.json())\n      .then(json => {\n        setAccessToken(json?.access_token);\n      });\n  }, []);\n\n  return { accessToken };\n}\n","import * as React from \"react\";\n\nexport function useUrl() {\n  const [subreddit, setSubreddit] = React.useState<string>();\n  const [article, setArticle] = React.useState<string>();\n\n  const onHash = React.useCallback(() => {\n    const hash = window.location.hash;\n    if (!hash) {\n      window.location.hash = \"popular\";\n      return;\n    }\n\n    const match = window.location.hash.match(\n      \"^#?([A-Za-z0-9_]+)/?([A-Za-z0-9_]+)?$\"\n    );\n\n    const [_, sub, art] = match ?? [];\n    setSubreddit(sub || undefined);\n    setArticle(art || undefined);\n\n    if (sub) {\n      document.title = \"Luna - \" + sub;\n    } else {\n      document.title = \"Luna\";\n    }\n  }, [setSubreddit, setArticle]);\n\n  const goHome = React.useCallback(() => {\n    window.location.hash = subreddit || \"\";\n  }, [subreddit]);\n\n  const goToArticle = React.useCallback((sub: string, art: string) => {\n    window.location.hash = `${sub}/${art}`;\n  }, []);\n\n  React.useEffect(() => {\n    window.addEventListener(\"hashchange\", onHash);\n    onHash();\n    return () => window.removeEventListener(\"hashchange\", onHash);\n  });\n\n  return { subreddit, article, goHome, goToArticle };\n}\n","import * as React from \"react\";\nimport \"./App.css\";\nimport { useSubreddit, Post, usePost, Reply } from \"./reddit/reddit\";\nimport { useUrl } from \"./reddit/url\";\n\nfunction App() {\n  const { subreddit, article } = useUrl();\n\n  if (subreddit && article) {\n    return <RepliesView subreddit={subreddit} article={article} />;\n  } else if (subreddit) {\n    return <PostsView subreddit={subreddit} />;\n  } else {\n    return <div className=\"App\">{<p>Loading...</p>}</div>;\n  }\n}\n\nconst PostsView: React.FC<{ subreddit: string }> = ({ subreddit }) => {\n  const { posts, loading, error } = useSubreddit(subreddit);\n  return (\n    <div className=\"App\">\n      {loading && <p>Loading...</p>}\n      {error && <p>Errora Whoops... {error.message}</p>}\n      {posts && posts.map(post => <PostView key={post.data.id} {...post} />)}\n    </div>\n  );\n};\n\nconst PostView: React.FC<Post> = post => {\n  const { goToArticle } = useUrl();\n  const { expanded } = post;\n  const { id, permalink, url, subreddit, selftext_html } = post.data;\n  const onDivClick = React.useCallback(() => window.open(url), [permalink]);\n\n  const onCommentClick = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement, MouseEvent>): void => {\n      evt.stopPropagation();\n      goToArticle(subreddit!, id);\n    },\n    [subreddit, id]\n  );\n\n  const onLinkClick = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement, MouseEvent>): void =>\n      evt.preventDefault(),\n    []\n  );\n\n  const domain = React.useMemo(\n    () => url.match(\"^https?://(?:www\\\\.)?(.+?)(?:/.*)?$\")?.[1],\n    [url]\n  );\n\n  return (\n    <div className=\"Post\" onClick={onDivClick}>\n      <div className=\"PostData\">\n        <a href={url} onClick={onLinkClick}>\n          {post.data.title}\n        </a>\n        <aside>{domain}</aside>\n        {expanded && selftext_html && (\n          <article dangerouslySetInnerHTML={{ __html: selftext_html }} />\n        )}\n      </div>\n      {!expanded && (\n        <aside className=\"CommentButton\" onClick={onCommentClick}>\n          <a>‚ùû</a>\n        </aside>\n      )}\n    </div>\n  );\n};\n\nconst RepliesView: React.FC<{ subreddit: string; article: string }> = ({\n  subreddit,\n  article\n}) => {\n  const { post, replies, loading, error } = usePost(subreddit, article);\n\n  React.useLayoutEffect(() => {\n    const anchors = document.querySelectorAll(\".ReplyData .md a\");\n    anchors.forEach(elem => {\n      const anchor = elem as HTMLAnchorElement;\n      anchor.target = \"_blank\";\n      if (anchor.href.includes(window.location.host)) {\n        anchor.href =\n          \"https://reddit.com\" +\n          anchor.href.slice(window.location.origin.length);\n      }\n    });\n  }, [replies]);\n\n  return (\n    <div className=\"App\">\n      {loading && <p>Loading...</p>}\n      {error && <p>Errora Whoops... {error.message}</p>}\n      {post && <PostView expanded {...post} />}\n      {replies &&\n        replies.map(reply => (\n          <ReplyView key={reply.data.id} index={-1} {...reply} />\n        ))}\n    </div>\n  );\n};\n\nconst ReplyView: React.FC<Reply> = reply => {\n  const { indent = 0, index } = reply;\n  const { body_html, replies } = reply.data;\n\n  const [expanded, setExpanded] = React.useState(true);\n\n  const divRef = React.useRef<HTMLDivElement | null>(null);\n\n  const hasChildren =\n    (replies?.data?.children.filter(child => !!child.data.body).length ?? 0) >\n    0;\n  const isFirst = index === 0;\n  const isTop = index === -1;\n\n  return (\n    <>\n      <div\n        className={\"Reply \" + (isTop ? \"Top \" : \"\")}\n        ref={divRef}\n        onClick={(e: any) => {\n          if (!hasChildren) return;\n          if (\n            e.target.tagName.toLowerCase() !== \"a\" &&\n            !window.getSelection()?.toString()\n          )\n            setExpanded(!expanded);\n        }}\n      >\n        <div style={{ display: \"flex\" }}>\n          {new Array(indent).fill(0).map(() => (\n            <div className=\"Indent\" />\n          ))}\n        </div>\n        <div\n          className={\n            \"ReplyData \" +\n            (hasChildren ? \"Children \" : \"\") +\n            (isFirst ? \"First \" : \"\")\n          }\n        >\n          <article dangerouslySetInnerHTML={{ __html: body_html }} />\n        </div>\n      </div>\n      {expanded &&\n        replies &&\n        replies.data.children\n          .filter(reply => !!reply.data.body)\n          .map((reply, index) => (\n            <ReplyView\n              key={reply.data.id + reply.data.author}\n              index={index}\n              indent={indent + 1}\n              {...reply}\n            />\n          ))}\n      {!expanded && <div className=\"Collapsed\" />}\n\n      {isTop && <div className=\"Collapsed\" />}\n    </>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}